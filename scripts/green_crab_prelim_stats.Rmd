```{r data read in}

# read in relevant documents for this data
# preliminary data used for calcium etc.
gc_dat <- read.csv("../data/prelim_gc_data.csv")

# updated with full data set 2023-01-06

gc_dat_fin <- read.csv("../data/Condo_Data_Raw_CML_WEL_1_6_23.csv")

gc_dat_fin$hemo_col <- factor(gc_dat_fin$hemo_col,
                           levels = c('1', '2', '3', '4', '5'))

gc_dat_fin$hemo_col <- as.factor(gc_dat_fin$hemo_col)

gc_dat_fin$hemo_ri <- as.numeric(gc_dat_fin$hemo_ri)

# data reclassification to avoid errors later

# libraries for data visualization
library(ggplot2)
library(dplyr)
library(gridExtra)
library(MASS)

```

```{r Ca vs. color UNFILTERED}

boxplot(ca ~ hemo_col, data = gc_dat_fin,
      xlab = "Hemolymph Color",
      ylab = "Calcium (ppm)",
      col= c('white', 'aliceblue', 'bisque', 'darksalmon','coral'),
      
      subset = period == "TRUE", outline = FALSE)

# appears that calcium increases as hemolymph color darkens
# n = 25 individual crabs
# n = 11, 10, 36, 6, 2
```

```{r RI vs. Color FILTERED for WELLS only crabs}

boxplot(hemo_ri ~ hemo_col, data = gc_dat_fin,
      xlab = "Hemolymph Color",
      ylab = "Hemolymph Refractive Index",
      col= c('white', 'aliceblue', 'bisque', 'darksalmon','coral'),
      subset = condo_id == "WL" & 
        outcome == c('Molted', 'Removed'))

# n = 223, 211, 324, 53, and 16

```


```{r Tukey HSD test and anova for color and RI fin filtered for WELLS}

fcol_fin <- factor(gc_dat_fin$hemo_col)
# color is on a scale of 1-5; appears as "numeric"; categorical factor

ri_col_aov_fin <- aov (hemo_ri ~ fcol_fin, data=gc_dat_fin,
                       subset = condo_id == "WL")
summary(ri_col_aov_fin)
# type 1 aov used for Tukey test
# tests between categories: is 1 dif. than 2, etc.

TukeyHSD(ri_col_aov_fin, conf.level = 0.95) 
```

```{r}

# wl_col_aov_fin <- aov (hemo_ri ~ hemo_col, data=gc_dat_fin, 
#                        subset = condo_id == "WL" & period == "TRUE" 
#                        & outcome == c('Molted', 'Removed'))
# summary(wl_col_aov_fin)
# # type 1 aov used for Tukey test
# # tests between categories: is 1 dif. than 2, etc.
# 
# TukeyHSD(wl_col_aov_fin, conf.level = 0.95) 

```
