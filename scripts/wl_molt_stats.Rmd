```{r .csv and library read in}

molt_dat <- read.csv("../data/wl_molt_dat.csv")
# read in .csv

library(car)
library(ggplot2)
library(dplyr)
# load relevant libraries for stats analysis
```

```{r ri and days to molt r plot}

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     main = "Hemolymph RI as Green Crabs Approach Molt (n=13)",
     xlim = rev(range(days_from_molt)),
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")
abline(lm (hemo_ri ~ days_from_molt, data = molt_dat), col = 4, lwd = 3)

# plots hemo ri vs days from molt for all 13 crabs
# need to reverse x axis to count down to molt
# appears to be downward trend in hemolymph RI as crabs approach molt
# need to investigate on an individual level
```

```{r ggplot scatter plot}

molt_dat %>% 
        # pipes molt data into ggplot
  ggplot(aes(x = days_from_molt, y = hemo_ri)) + 
        # populates plot with hemo ri info and defines color with crab ID
    geom_point() + geom_smooth(method=lm) + 
        # specifies type of plot -- linear model with 95 percent confidence
        scale_x_reverse() + 
        # reverses x axis so information counts down to molt
        xlab("Days from molt") + 
        ylab ("Hemolymph RI") +
        ggtitle("Hemolymph RI as green crabs approach molt (n = 13)")
        # renames x and y labels and title

```


```{r}

molt_dat %>% 
        # pipes molt data into ggplot
  ggplot(aes(x = days_from_molt, y = hemo_ri)) + 
        # populates plot with hemo ri info and defines color with crab ID
    geom_point() + geom_smooth(method=lm, se=FALSE) + 
        # specifies type of plot -- linear model without confidence int
        scale_x_reverse() + 
        # reverses x axis so information counts down to molt
        xlab("Days from molt") + 
        ylab ("Hemolymph RI") +
        ggtitle("Hemolymph RI as green crabs approach molt (n = 13)")
        # renames x and y labels and title


```

```{r hemo ri vs days from molt ggplot with gridded background}

library(ggplot2)
library(dplyr)

molt_dat %>% 
        # pipes molt data into ggplot
  ggplot(aes(x = days_from_molt, y = hemo_ri, colour = crab_id)) + 
        # populates plot with hemo ri info and defines color with crab ID
    geom_point() + geom_line() + 
        # specifies type of plot - scatter linear plot with crab IDs
        scale_x_reverse() + 
        # reverses x axis so information counts down to molt
        xlab("Days from molt") + 
        ylab ("Hemolymph RI") +
        ggtitle("Hemolymph RI as green crabs approach molt (n = 13)") +
        # renames x and y labels and title
        labs(col = "Crab ID") 
        # changes legend title
```

```{r hemo ri vs days from molt ggplot without gridded background}
library(ggplot2)
library(dplyr)

molt_dat %>% 
        # pipes molt data into ggplot
  ggplot(aes(x = days_from_molt, y = hemo_ri, colour = crab_id)) + 
        # populates plot with hemo ri info and defines color with crab ID
    geom_point() + geom_line() +
        # specifies type of plot - scatter linear plot with crab ids
        scale_x_reverse() + 
        # reverses x axis so information counts down to molt
        xlab("Days from molt") + 
        ylab ("Hemolymph RI") +
        ggtitle("Hemolymph RI as green crabs approach molt (n = 13)") +
        # renames x and y labels and title
        labs(col = "Crab ID") + 
        # changes legend title
        theme(panel.grid.major = element_blank(),
              panel.grid.minor = element_blank(), 
              panel.background = element_blank())
        # removes background grid from plot

```

```{r ri days from molt anova}
ri_mod <- lm(hemo_ri ~ days_from_molt, data = molt_dat)
summary(ri_mod)
anova(ri_mod)
car::Anova(ri_mod, type = 3)

# linear models for significance testing 

```

```{r hemo color and days to molt plot}

plot(hemo_color ~ days_from_molt, data = molt_dat,
     main = "Hemolymph Color as Green Crabs Approach Molt (n=13)",
     xlim = rev(range(days_from_molt)),
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color")
abline(lm (hemo_color ~ days_from_molt, data = molt_dat), col = 4, lwd = 3)

# plots hemo color vs days from molt for all 13 crabs
# need to reverse x axis to count down to molt
# doesn't appear to be strong trend or correlation

```

```{r hemo color vs days from molt ggplot with gridded background}
library(ggplot2)
library(dplyr)

molt_dat %>% 
        # pipes molt data into ggplot
  ggplot(aes(x = days_from_molt, y = hemo_color, colour = crab_id)) + 
        # populates plot with hemo color info and defines color with crab ID
    geom_point() + geom_line() + 
        # specifies type of plot
        scale_x_reverse() + 
        # reverses x axis so information counts down to molt
        xlab("Days from molt") + 
        ylab ("Hemolymph Color") +
        ggtitle("Hemolymph color as green crabs approach molt (n = 13") +
        # renames x and y labels and title
        labs(col = "Crab ID")
        # changes legend title
```

```{r hemo color anova}

col_mod <- lm(hemo_color ~ days_from_molt, data = molt_dat)
summary(col_mod)
anova(col_mod)
car::Anova(col_mod, type = 3)

# linear models for significance testing 

```

```{r overlay of hemo color and days to molt plot}

par(mar = c(5, 4, 4, 4) + 0.3)
plot(hemo_ri ~ days_from_molt, data = molt_dat,
     main = "Hemolymph RI and Color as Green Crabs Approach Molt (n=13)",
     xlim = rev(range(days_from_molt)),
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     pch = 16, col = 2)
abline(lm (hemo_ri ~ days_from_molt, data = molt_dat), col = 4, lwd = 3)
par(new = TRUE)                             
plot(hemo_color ~ days_from_molt, data = molt_dat,
     xlim = rev(range(days_from_molt)),
     xlab = "Days From Molt",
     pch = 17, col =3,
     axes = FALSE)
abline(lm (hemo_color ~ days_from_molt, data = molt_dat), col = 6, lwd = 3)
axis(side = 4, at = pretty(range(c(1, 2, 3, 4, 5))))      
mtext("Hemolymph Color", side = 4, line = 3) 


# overlaid two graphs to see hemo ri and color trends 
# some issues to resolve still; look at r graph gallery and gg plot
```

```{r individual crab hemo color trends over time}

# individual hemo color graphs over time

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBGB",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBGG",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBGB",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBGY",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBKR",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBWK",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBYB",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGBR",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGBY",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGGW",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGGY",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGKG",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGKR",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")

plot(hemo_color ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGW",
     xlab = "Days From Molt", 
     ylab = "Hemolymph Color",
     type = "b")
```

```{r individual ri graphs over time}

# individual RI graphs over time
# appears that as crabs approach molt, RI decreases

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBGB",
     xlab = "Days From Molt",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBGG",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBGB",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBGY",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBKR",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBWK",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GBYB",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGBR",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGBY",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGGW",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGGY",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGKG",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGKR",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")

plot(hemo_ri ~ days_from_molt, data = molt_dat,
     subset = crab_id == "GGW",
     xlab = "Days From Molt", 
     ylab = "Hemolymph RI",
     type = "b")
```