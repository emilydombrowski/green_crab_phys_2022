```{r data read in}

# read in relevant documents for this data
gc_dat <- read.csv("../data/prelim_gc_data.csv")

# libraries for data visualization
library(ggplot2)
library(gridExtra)
library(scatterplot3d)
library(MASS)
```

```{r RI vs. Calcium Plot}

plot(Ca ~ RI, data = gc_dat, 
      main = "RI vs. Calcium",
      xlab = "Hemolymph RI (%)",
      ylab = "Calcium (ppm)")
abline(lm (Ca ~ RI, data = gc_dat), col = 4, lwd = 3)

# correlation plot to look at RI vs. Calcium
# doesn't appear to be a trend

```

```{r}
gc_dat %>% 
        # pipes molt data into ggplot
  ggplot(aes(x = RI, y = Ca)) + 
        # populates plot with hemo ri and ca info
    geom_point() + geom_smooth(method=lm) + 
        # specifies type of plot -- linear model with 95 percent confidence
        xlab("Hemolymph RI") + 
        ylab ("Calcium (ppm)") +
        ggtitle("Hemolymph RI vs. Calcium, (n=66)") +
        # renames x and y labels and title
      xlim(3, 12)
```

```{r}

ca_ri_mod <- lm(Ca ~ RI, data = gc_dat)
nobs(ca_ri_mod) # tells that there are 66 observations used in this model
summary(ca_ri_mod)
anova(ca_ri_mod)
car::Anova(ca_ri_mod, type = 3)

```

```{r}

boxplot( RI ~ Color, data = gc_dat, 
      main = "RI vs. Hemolymph Color",
      xlab = "Hemolymph Color (on a scale of 1-5)",
      ylab = "Hemolymph RI (%)" )

# box plot comparing average RIs for different colored hemolymph
# appears that there are some differences between hemo RI 
# if you want to make graph fancy: make different colors correspond 
# to colors of hemolymph harvested
```

```{r Ca vs. color}

boxplot( Ca ~ Color, data = gc_dat, 
      main = "Calcium vs. Hemolymph Color",
      xlab = "Hemolymph Color (on a scale of 1-5)",
      ylab = "Calcium (ppm)" )

# appears that calcium increases as hemolymph color darkens
```

```{r interaction effects of RI and Ca on hemo color}

ri_col_mod = lm(Color ~ RI + Ca + RI:Ca,
              data = gc_dat)

summary(ri_col_mod)
anova(ri_col_mod)
car::Anova(ri_col_mod, type = 3)

# interaction model to assess whether or not hemolymph color is altered by
# the interaction between RI and Ca
```